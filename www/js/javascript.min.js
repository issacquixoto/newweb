$(document).ready(function(){function e(){n={body:3,sta:3,int:3,feel:3,will:3}}function t(){var e=0;$.each(n,function(t,o){e+=o}),a=l[s].point-e,$("#overRacePoint").text(a)}function o(){$.each(n,function(e,t){$("."+e+"Point .point").html(t),e===i.other01?($("."+e+"Point .amend").html(r[e]+1),c[e]=r[e]+t+1):($("."+e+"Point .amend").html(r[e]),c[e]=r[e]+t),$("."+e+"Point .total").html(c[e])})}var a,s,n={body:3,sta:3,int:3,feel:3,will:3},r={},i={},c={},l={a1:{point:26,correction:{body:2,sta:2,int:0,feel:0,will:1}},a2:{point:26,correction:{body:0,sta:0,int:2,feel:0,will:1}},b1:{point:24,correction:{body:0,sta:0,int:1,feel:0,will:2}},b2:{point:24,correction:{body:1,sta:1,int:0,feel:1,will:0}},b3:{point:24,correction:{body:1,sta:1,int:0,feel:0,will:0}},b4:{point:24,correction:{body:1,sta:0,int:0,feel:2,will:0}},c1:{point:22,correction:{body:-1,sta:-1,int:1,feel:0,will:1}},c2:{point:22,correction:{body:0,sta:0,int:1,feel:1,will:-1}},c3:{point:22,correction:{body:0,sta:0,int:0,feel:0,will:0}},c4:{point:22,correction:{body:1,sta:1,int:-1,feel:1,will:-1}},d1:{point:20,correction:{body:0,sta:0,int:0,feel:0,will:0}},d2:{point:20,correction:{body:-1,sta:-1,int:-1,feel:2,will:-1}}};$("#characterRace").on("change",function(){e(),s=$(characterRace).find("option:selected").val(),$("#racePoint").text(l[s].point),r=l[s].correction,$("#otherRaceCorrection > div").css("display","none"),"c3"===s?$("#otherRaceCorrection .c3Choose").css("display","block"):"b3"===s&&$("#otherRaceCorrection .other01").css("display","block"),t(),o()}),$('#characterPoint input[value="+"]').on("click",function(){var e=$(this).attr("class");a<=0&&($(".error_04").css("display","block"),returnamend),void 0===s&&(s="a1",r=l.a1.correction),n[e]<6?(++n[e],$(".error_01").css("display","none"),$(".error_02").css("display","none"),t(),o()):$("."+e+"Point .error_02").css("display","inline-block")}),$('#characterPoint input[value="-"]').on("click",function(){var e=$(this).attr("class");$(".error_04").css("display","none"),void 0===s&&(s="a1",r=l.a1.correction),n[e]>3?(--n[e],$(".error_01").css("display","none"),$(".error_02").css("display","none"),t(),o()):$("."+e+"Point .error_01").css("display","inline-block")}),$("#otherRaceCorrection input").on("change",function(){var e=$(this).attr("name"),a=$('input[name="'+e+'"]:checked').val();if(i[e]!==a){if(i[e]=a,"c3Choose"===e&&"add1"===i.c3Choose)return $("#otherRaceCorrection > div").css("display","none"),$("#otherRaceCorrection .c3Choose").css("display","block"),void $("#otherRaceCorrection .other01").css("display","block");"c3Choose"!==e||"add3"!==i.c3Choose?(t(),o()):$("#otherRaceCorrection > div").css("display","block")}})}),$(document).ready(function(){function e(){var e=parseInt(s("#player1","left"));e<=0?$("#player1").css("left",e+"px"):$("#player1").css("left",e-d+"px")}function t(){var e=parseInt(s("#player1","top"));e<=0?$("#player1").css("top",e+"px"):$("#player1").css("top",e-d+"px")}function o(){var e=$("#gbody").width()-10,t=parseInt(s("#player1","left"));t>=e?$("#player1").css("left",t+"px"):$("#player1").css("left",t+d+"px")}function a(){var e=$("#gbody").height()-10,t=parseInt(s("#player1","top"));t>=e?$("#player1").css("top",t+"px"):$("#player1").css("top",t+d+"px")}function s(e,t){var o=/\d+/;return $(e).css(t).match(o)[0]}function n(){$("#My-bullet >div").each(function(){var e=parseInt(s(this,"top")),t=parseInt(s(this,"left")),o=e+parseInt($(this).attr("top")),a=t+parseInt($(this).attr("left"));e<=10||e>=600?$(this).remove():t<=10||t>=790?$(this).remove():$(this).css({top:o+"px",left:a+"px"})}),$("#enemy-bullet >div").each(function(){var e=parseInt(s(this,"top")),t=parseInt(s(this,"left")),o=e+parseInt($(this).attr("top")),a=t+parseInt($(this).attr("left"));e<=10||e>=600?$(this).remove():t<=10||t>=790?$(this).remove():$(this).css({top:o+"px",left:a+"px"})})}function r(e){return{t:parseInt(s(e,"top")),h:parseInt(s(e,"top"))+parseInt(s(e,"height")),l:parseInt(s(e,"left")),w:parseInt(s(e,"left"))+parseInt(s(e,"width"))}}function i(e,t){var o=r(t),a=r(e);a.t>=o.t&&a.t<=o.h?c(e,t,o,a):a.h>=o.t&&a.h<=o.h&&c(e,t,o,a)}function c(e,t,o,a){a.l>=o.l&&a.l<=o.w?l(e,t):a.w>=o.l&&a.w<=o.w&&l(e,t)}function l(e,t){e.remove();var o=t.attr("hp");o>1?t.attr("hp",o-1):t.remove(),o<5&&t.css("background","red")}function p(e,t,o,a,s){if(e.hasClass("hover")){var n=o.css("left"),r=o.css("top"),i=t+90,c=t+180,l=t-90,p=(Math.sin(t*Math.PI/180)*s).toFixed(8),h=(-Math.cos(t*Math.PI/180)*s).toFixed(8),d=(Math.sin(i*Math.PI/180)*s).toFixed(8),$=(-Math.cos(i*Math.PI/180)*s).toFixed(8),y=(Math.sin(c*Math.PI/180)*s).toFixed(8),f=(-Math.cos(c*Math.PI/180)*s).toFixed(8),v=(Math.sin(l*Math.PI/180)*s).toFixed(8),u="<div class='bullet' style='left:"+n+";top:"+r+"' top='"+h+"' left='"+p+"'></div>",k="<div class='bullet' style='left:"+n+";top:"+r+"' top='"+$+"' left='"+d+"'></div>",b="<div class='bullet' style='left:"+n+";top:"+r+"' top='"+f+"' left='"+y+"'></div>",m="<div class='bullet' style='left:"+n+";top:"+r+"' top='"+(-Math.cos(l*Math.PI/180)*s).toFixed(8)+"' left='"+v+"'></div>";a.append(u),a.append(k),a.append(b),a.append(m)}}var h=0,d=15;$(document).keydown(function(e){switch(e.keyCode){case 37:$("#key .left").addClass("hover");break;case 38:$("#key .up").addClass("hover");break;case 39:$("#key .right").addClass("hover");break;case 40:$("#key .down").addClass("hover");break;case 90:$("#key .keyz").addClass("hover");break;case 88:$("#key .keyx").addClass("hover")}}),$(document).keyup(function(e){switch(e.keyCode){case 37:$("#key .left").removeClass("hover");break;case 38:$("#key .up").removeClass("hover");break;case 39:$("#key .right").removeClass("hover");break;case 40:$("#key .down").removeClass("hover");break;case 90:$("#key .keyz").removeClass("hover");break;case 88:$("#key .keyx").removeClass("hover")}}),setInterval(function(){$("#key .left").hasClass("hover")&&e(),$("#key .up").hasClass("hover")&&t(),$("#key .right").hasClass("hover")&&o(),$("#key .down").hasClass("hover")&&a(),n();var s=$("#player1"),r=$("#enemy .brick");$("#enemy-bullet >div").each(function(){i($(this),s)}),$("#My-bullet >div").each(function(){i($(this),r)})},100),setInterval(function(){h+=25;var e=$("#key .keyz"),t=$("#enemy .brick"),o=$("#enemy-bullet");p(e,h,t,o,15)},100),$(document).keypress(function(){$("#keydown").text($("#player1").css("top")),$("#keyup").text($("#player1").css("left"))}),$(document).keyup(function(){})});